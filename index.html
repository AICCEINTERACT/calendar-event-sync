<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Add to Calendar Button</title>
</head>
<body>

<!-- Custom element definition -->
<add-to-calendar-button
  name="Meeting with Client"
  options="Apple,Google"
  location="World Wide Web"
  startDate="2024-02-10"
  endDate="2024-02-10"
  startTime="10:15"
  endTime="23:30"
  timeZone="America/Los_Angeles"
></add-to-calendar-button>

<!-- Script sourcing from CDN -->
<script src="https://cdn.jsdelivr.net/npm/add-to-calendar-button@2" async defer></script>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    const buttons = document.querySelectorAll('add-to-calendar-button');
    buttons.forEach(button => {
      button.addEventListener('click', function() {
        const { name, options, location, startDate, endDate, startTime, endTime, timeZone } = button.attributes;
        const title = name.value;
        const [apple, google] = options.value.split(',');
        const urlApple = `https://calendar.apple.com/calendar/render#event=${encodeURIComponent(title)}&location=${encodeURIComponent(location.value)}&startDate=${startDate.value}T${startTime.value}&endDate=${endDate.value}T${endTime.value}&timeZone=${timeZone.value}`;
        const urlGoogle = `https://www.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(title)}&location=${encodeURIComponent(location.value)}&dates=${startDate.value.replace(/-/g, '')}T${startTime.value.replace(/:/g, '')}/${endDate.value.replace(/-/g, '')}T${endTime.value.replace(/:/g, '')}&ctz=${timeZone.value}`;
        window.open(apple === 'true' ? urlApple : urlGoogle);
      });
    });
  });
</script>

</body>
</html>
